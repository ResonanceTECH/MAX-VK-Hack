# Backend API Documentation

![Python](https://img.shields.io/badge/Python-3.11-3776ab.svg)


**REST API –¥–ª—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã MAX**

Backend –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç RESTful API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –≥—Ä—É–ø–ø–∞–º–∏, —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –Ω–æ–≤–æ—Å—Ç—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- [–ë–∞–∑–æ–≤—ã–π URL](#–±–∞–∑–æ–≤—ã–π-url)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
- [API Endpoints](#api-endpoints)
  - [–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏](#–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
  - [–ì—Ä—É–ø–ø—ã](#–≥—Ä—É–ø–ø—ã)
  - [–°–æ–æ–±—â–µ–Ω–∏—è](#—Å–æ–æ–±—â–µ–Ω–∏—è)
  - [–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏](#–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏)
  - [–ù–æ–≤–æ—Å—Ç–∏](#–Ω–æ–≤–æ—Å—Ç–∏)
  - [–ü–æ–¥–¥–µ—Ä–∂–∫–∞](#–ø–æ–¥–¥–µ—Ä–∂–∫–∞)
  - [–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ](#–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ö–æ–¥—ã –æ—à–∏–±–æ–∫](#–∫–æ–¥—ã-–æ—à–∏–±–æ–∫)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

## –û–±–∑–æ—Ä

Backend API –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **FastAPI** –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Max initData
- ‚úÖ –ú–Ω–æ–≥–æ—Ä–æ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (student, teacher, admin, support)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –≥—Ä—É–ø–ø–∞–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Å —Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥–æ–º
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å —Ç–∏–∫–µ—Ç–∞–º–∏
- ‚úÖ –ü–æ–ª–Ω–∞—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ **initData** –æ—Ç –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ MAX.

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã (–∫—Ä–æ–º–µ `/health` –∏ `/`) –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫:

```
X-Init-Data: hash=xxx&user=xxx&auth_date=xxx&...
```

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π

–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ä–æ–ª—å –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
X-Selected-Role: student|teacher|admin|support
```

–ï—Å–ª–∏ —Ä–æ–ª—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: `admin` > `support` > `teacher` > `student`).

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```env
SKIP_AUTH=true
SKIP_INITDATA_VERIFY=true
DEV_USER_MAX_ID=96855100
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ**: –í production —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `false`!

## –ë–∞–∑–æ–≤—ã–π URL

- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: `https://localhost/api`
- **Production**: `https://178.72.139.15.nip.io/api`

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

```typescript
{
  id: number              // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
  max_user_id: number     // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Max
  fio: string             // –ü–æ–ª–Ω–æ–µ –§–ò–û
  first_name: string       // –ò–º—è
  last_name: string       // –§–∞–º–∏–ª–∏—è
  middle_name?: string    // –û—Ç—á–µ—Å—Ç–≤–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  role: string            // –†–æ–ª—å: 'student' | 'teacher' | 'admin' | 'support'
  phone?: string          // –¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  email?: string          // Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}
```

### Group (–ì—Ä—É–ø–ø–∞)

```typescript
{
  id: number
  name: string            // –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò–ö–ë–û-16-22")
  semester?: number       // –°–µ–º–µ—Å—Ç—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  year?: number          // –ì–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}
```

### Message (–°–æ–æ–±—â–µ–Ω–∏–µ)

```typescript
{
  id: number
  from_user_id: number
  from_user_fio: string
  to_user_id: number
  to_user_fio: string
  group_id?: number       // ID –≥—Ä—É–ø–ø—ã (–µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –≥—Ä—É–ø–ø—ã)
  group_name?: string     // –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  text: string
  status: 'unread' | 'read'
  created_at: string      // ISO 8601 —Ñ–æ—Ä–º–∞—Ç
}
```

### News (–ù–æ–≤–æ—Å—Ç—å)

```typescript
{
  id: number
  title: string
  description: string
  hashtags?: string       // –•—ç—à—Ç–µ–≥–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
  target_role?: string    // –¶–µ–ª–µ–≤–∞—è —Ä–æ–ª—å: 'student' | 'teacher' | 'all' | null
  target_group_id?: number // ID —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã (null –¥–ª—è –≤—Å–µ—Ö)
  created_by: number     // ID —Å–æ–∑–¥–∞—Ç–µ–ª—è
  created_at: string
  is_published: boolean
}
```

### SupportTicket (–û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É)

```typescript
{
  id: number
  user_id: number
  user_fio: string
  text: string
  status: 'new' | 'in_progress' | 'resolved'
  assigned_to?: number    // ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
  created_at: string
  updated_at: string
}
```

## API Endpoints

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

#### `GET /user/info`

–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `X-Init-Data` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `X-Selected-Role` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "max_user_id": 96855100,
  "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
  "role": "student",
  "all_roles": [
    {"id": 1, "role": "student", "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"},
    {"id": 2, "role": "teacher", "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"}
  ]
}
```

---

### –ì—Ä—É–ø–ø—ã

#### `GET /groups`

–ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–î–æ—Å—Ç—É–ø:** `student`, `teacher`

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `X-Init-Data` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "name": "–ò–ö–ë–û-16-22",
    "semester": 1,
    "year": 2024,
    "is_headman": false
  }
]
```

#### `GET /groups/{group_id}/students`

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≥—Ä—É–ø–ø—ã.

**–î–æ—Å—Ç—É–ø:** 
- `student` (—Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–π –≥—Ä—É–ø–ø—ã)
- `teacher` (—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –≥—Ä—É–ø–ø)
- `admin` (–≤—Å–µ –≥—Ä—É–ø–ø—ã)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `group_id` (path) - ID –≥—Ä—É–ø–ø—ã

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "max_user_id": 96855100,
    "is_headman": true
  }
]
```

---

### –°–æ–æ–±—â–µ–Ω–∏—è

#### `GET /messages`

–ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–î–æ—Å—Ç—É–ø:** –í—Å–µ —Ä–æ–ª–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `status` (query, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É: `unread` | `read`
- `group_id` (query, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –§–∏–ª—å—Ç—Ä –ø–æ –≥—Ä—É–ø–ø–µ

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "from_user_id": 2,
    "from_user_fio": "–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á",
    "to_user_id": 1,
    "to_user_fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "group_id": null,
    "group_name": null,
    "text": "–ü—Ä–∏–≤–µ—Ç!",
    "status": "unread",
    "created_at": "2024-11-14T10:00:00Z"
  }
]
```

#### `PUT /messages/{message_id}/status`

–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–æ–æ–±—â–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `message_id` (path) - ID —Å–æ–æ–±—â–µ–Ω–∏—è

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "read"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message_id": 1,
  "status": "read"
}
```

#### `GET /messages/stats`

–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π.

**–û—Ç–≤–µ—Ç:**
```json
{
  "unread": 5,
  "read": 10,
  "total": 15
}
```

---

### –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏

#### `GET /teachers`

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π.

**–î–æ—Å—Ç—É–ø:** `student`, `teacher`

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "fio": "–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤–∏—á",
    "phone": "+79001234567",
    "email": "sidorov@example.com"
  }
]
```

---

### –ù–æ–≤–æ—Å—Ç–∏

#### `GET /news`

–ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–î–æ—Å—Ç—É–ø:** –í—Å–µ —Ä–æ–ª–∏

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "title": "–í–∞–∂–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏",
    "hashtags": "#–Ω–æ–≤–æ—Å—Ç—å #–≤–∞–∂–Ω–æ",
    "target_role": "student",
    "target_group_id": null,
    "created_at": "2024-11-14T10:00:00Z",
    "is_published": true
  }
]
```

---

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞

#### `GET /support/tickets`

–ü–æ–ª—É—á–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

**–î–æ—Å—Ç—É–ø:** `support`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `status` (query, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É: `new` | `in_progress` | `resolved`

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "user_id": 1,
    "user_fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "text": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É",
    "status": "new",
    "assigned_to": null,
    "created_at": "2024-11-14T10:00:00Z",
    "updated_at": "2024-11-14T10:00:00Z"
  }
]
```

#### `PUT /support/tickets/{ticket_id}/status`

–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è.

**–î–æ—Å—Ç—É–ø:** `support`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ticket_id` (path) - ID –æ–±—Ä–∞—â–µ–Ω–∏—è

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "in_progress"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true
}
```

#### `GET /support/stats`

–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

**–î–æ—Å—Ç—É–ø:** `support`

**–û—Ç–≤–µ—Ç:**
```json
{
  "new": 5,
  "in_progress": 3,
  "resolved": 10,
  "total": 18
}
```

---

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –°—Ç—É–¥–µ–Ω—Ç—ã

##### `GET /admin/students`

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.

**–î–æ—Å—Ç—É–ø:** `admin`

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "max_user_id": 96855100,
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phone": "+79001234567",
    "email": "ivanov@example.com"
  }
]
```

##### `POST /admin/students`

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "max_user_id": 96855100,
  "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
  "phone": "+79001234567",
  "email": "ivanov@example.com"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "success": true
}
```

##### `PUT /admin/students/{student_id}`

–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á",
  "phone": "+79001234568",
  "email": "newemail@example.com"
}
```

##### `DELETE /admin/students/{student_id}`

–£–¥–∞–ª–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞.

---

#### –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏

##### `GET /admin/teachers`

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π.

##### `POST /admin/teachers`

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "max_user_id": 96855101,
  "fio": "–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á",
  "phone": "+79001234569",
  "email": "petrov@example.com"
}
```

##### `PUT /admin/teachers/{teacher_id}`

–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.

##### `DELETE /admin/teachers/{teacher_id}`

–£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.

---

#### –ì—Ä—É–ø–ø—ã

##### `GET /admin/groups`

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã.

##### `POST /admin/groups`

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "–ò–ö–ë–û-16-22",
  "semester": 1,
  "year": 2024
}
```

##### `PUT /admin/groups/{group_id}`

–û–±–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É.

##### `DELETE /admin/groups/{group_id}`

–£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É.

##### `POST /admin/groups/{group_id}/students/{student_id}`

–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –≥—Ä—É–ø–ø—É.

##### `DELETE /admin/groups/{group_id}/students/{student_id}`

–£–¥–∞–ª–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ –≥—Ä—É–ø–ø—ã.

##### `PUT /admin/groups/{group_id}/headman/{student_id}`

–ù–∞–∑–Ω–∞—á–∏—Ç—å —Å—Ç–∞—Ä–æ—Å—Ç—É –≥—Ä—É–ø–ø—ã.

---

#### –ù–æ–≤–æ—Å—Ç–∏

##### `POST /admin/news`

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "title": "–í–∞–∂–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏",
  "hashtags": "#–Ω–æ–≤–æ—Å—Ç—å #–≤–∞–∂–Ω–æ",
  "target_role": "student",
  "target_group_id": null
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "success": true
}
```

---

## ‚ùå –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `200` | –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å |
| `400` | –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) |
| `401` | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π initData) |
| `403` | –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤) |
| `404` | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| `500` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

**401 Unauthorized:**
```json
{
  "detail": "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç initData"
}
```

**403 Forbidden:**
```json
{
  "detail": "–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏"
}
```

**404 Not Found:**
```json
{
  "detail": "–ì—Ä—É–ø–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
}
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|----------|--------------|
| `POSTGRES_HOST` | –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `db` |
| `POSTGRES_PORT` | –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `5432` |
| `POSTGRES_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î | `maxbot` |
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î | `maxbot123` |
| `POSTGRES_DB` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `maxbot_db` |
| `SKIP_AUTH` | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (dev) | `true` |
| `SKIP_INITDATA_VERIFY` | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É initData (dev) | `true` |
| `DEV_USER_MAX_ID` | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è dev —Ä–µ–∂–∏–º–∞ | `96855100` |
| `CORS_ORIGINS` | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins –¥–ª—è CORS | `*` |

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript/TypeScript (Axios)

```typescript
import axios from 'axios';

const api = axios.create({
  baseURL: 'https://localhost/api',
  headers: {
    'X-Init-Data': initData, // –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ Max WebApp
    'X-Selected-Role': 'student' // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  }
});

// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
const userInfo = await api.get('/user/info');

// –ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø—ã
const groups = await api.get('/groups');

// –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
const messages = await api.get('/messages', {
  params: {
    status: 'unread',
    group_id: 1
  }
});

// –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–æ–æ–±—â–µ–Ω–∏—è
await api.put('/messages/1/status', {
  status: 'read'
});
```

### Python (httpx)

```python
import httpx

headers = {
    'X-Init-Data': init_data,
    'X-Selected-Role': 'student'
}

async with httpx.AsyncClient(base_url='https://localhost/api') as client:
    # –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    response = await client.get('/user/info', headers=headers)
    user_info = response.json()
    
    # –ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø—ã
    groups = await client.get('/groups', headers=headers)
    
    # –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
    messages = await client.get('/messages', 
                                params={'status': 'unread'},
                                headers=headers)
```

### cURL

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
curl -X GET "https://localhost/api/user/info" \
  -H "X-Init-Data: hash=xxx&user=xxx&auth_date=xxx"

# –ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø—ã
curl -X GET "https://localhost/api/groups" \
  -H "X-Init-Data: hash=xxx&user=xxx&auth_date=xxx"

# –°–æ–∑–¥–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ (admin)
curl -X POST "https://localhost/api/admin/students" \
  -H "X-Init-Data: hash=xxx&user=xxx&auth_date=xxx" \
  -H "X-Selected-Role: admin" \
  -H "Content-Type: application/json" \
  -d '{
    "max_user_id": 96855100,
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "phone": "+79001234567",
    "email": "ivanov@example.com"
  }'
```

---

## Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **Swagger UI**: `https://localhost/api/docs`
- **ReDoc**: `https://localhost/api/redoc`
- **OpenAPI JSON**: `https://localhost/api/openapi.json`

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
cd miniapp/backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### –ó–∞–ø—É—Å–∫ –≤ Docker

```bash
docker compose up --build backend
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:8000/health

# Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
open http://localhost:8000/docs
```

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–°–º. —Ñ–∞–π–ª [LICENSE](../../LICENSE) –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

---

## –ê–≤—Ç–æ—Ä—ã

- –ü–∞—Ä—Ö–æ–º–µ–Ω–∫–æ –ì–µ–æ—Ä–≥–∏–π –î–º–∏—Ç—Ä–∏–µ–≤–∏—á
- –ß—É–≥—É–Ω–æ–≤–∞ –î–∞—Ä—å—è –ò–≥–æ—Ä–µ–≤–Ω–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞ MAX-VK-Hack.

